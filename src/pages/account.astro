---
import Layout from "../layouts/Layout.astro";
import { supabase } from "../lib/supabase";

const { cookies, redirect } = Astro;

const { data, error } = await supabase.auth.getUser()

if (data.user !== null) {
    redirect("/login");
}

const email = data.user.email;
---

<Layout title="GameShack - dashboard">
    <section class="mx-4">
      <h1 class="mt-20">Welcome {email}</h1>
      <p>We are happy to see you here</p>
      <form action="/api/auth/signout">
        <button type="submit">Sign out</button>
      </form>
    </section>
  </Layout>